(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[843],{9119:function(e,s,r){Promise.resolve().then(r.bind(r,2292))},2292:function(e,s,r){"use strict";r.r(s),r.d(s,{default:function(){return f}});var t=r(7437),a=r(2265),l=r(6336),n=r(4041),i=r(9311),d=r(3023),c=r(4861);function o(e){let{onSelect:s,selectedSpreadId:r}=e,[l,n]=(0,a.useState)(null),o=e=>{s(e),n(null)},m=e=>{n(l===e?null:e)};return(0,t.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:c.qL.map(e=>(0,t.jsx)("div",{className:(0,i.cn)("bg-card rounded-lg border border-border overflow-hidden transition-all duration-300",r===e.id?"border-secondary card-glow":"hover:border-secondary/50",l===e.id?"col-span-1 sm:col-span-2 lg:col-span-4 row-span-2":""),children:(0,t.jsxs)("div",{className:"p-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-secondary",children:e.name}),(0,t.jsx)(d.z,{variant:"ghost",size:"sm",onClick:()=>m(e.id),className:"text-xs",children:l===e.id?"Свернуть":"Подробнее"})]}),(0,t.jsx)("p",{className:"mt-2 text-sm text-muted-foreground",children:e.description}),l===e.id&&(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsx)("h4",{className:"text-sm font-medium mb-2",children:"Позиции карт:"}),(0,t.jsx)("ul",{className:"space-y-2",children:e.positions.map((e,s)=>(0,t.jsxs)("li",{className:"text-sm",children:[(0,t.jsx)("span",{className:"font-medium text-secondary",children:e.name}),": ",e.description]},s))})]}),(0,t.jsx)(d.z,{variant:r===e.id?"secondary":"outline",size:"sm",className:"mt-4 w-full",onClick:()=>o(e.id),children:r===e.id?"Выбрано":"Выбрать"})]})},e.id))})}var m=r(647);let u=a.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,t.jsx)("textarea",{className:(0,i.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:s,...a})});u.displayName="Textarea";var x=r(2621);function f(){let[e,s]=(0,a.useState)(""),[r,i]=(0,a.useState)(""),[f,h]=(0,a.useState)(null),[p,j]=(0,a.useState)(!1),[g,b]=(0,a.useState)(0),[v,N]=(0,a.useState)(""),{toast:y}=(0,x.p)(),w=()=>{let e=(6e4*Math.random()+12e4)/1e3,s=0,r=setInterval(()=>{s++;let t=s/e*100;b(t),s>=e&&clearInterval(r)},1e3);return r},S=async()=>{if(!e){y({title:"Выберите расклад",description:"Пожалуйста, выберите тип расклада перед началом гадания.",variant:"destructive"});return}j(!0),b(0);let s=w();try{let t=(0,c.$i)(e,r),a=await fetch("/api/tarot",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({spreadType:t.spreadType,question:t.question,cards:t.cards.map(e=>({name:e.card.nameRu,position:e.position}))})});if(!a.ok)throw Error("Failed to get interpretation");let l=await a.json(),n=JSON.parse(localStorage.getItem("tarotReadings")||"[]");localStorage.setItem("tarotReadings",JSON.stringify([...n,t])),clearInterval(s),h(t),N(l.interpretation)}catch(e){clearInterval(s),y({title:"Ошибка при создании расклада",description:"Пожалуйста, попробуйте еще раз.",variant:"destructive"})}finally{j(!1),b(0)}};return(0,t.jsxs)("main",{className:"min-h-screen flex flex-col",children:[(0,t.jsx)(l.Navbar,{}),(0,t.jsx)(n.StarsBackground,{}),(0,t.jsxs)("div",{className:"flex-1 container mx-auto px-4 py-8",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-center mb-2",children:"Гадание на Таро"}),(0,t.jsx)("p",{className:"text-muted-foreground text-center mb-8",children:"Выберите расклад, задайте вопрос и получите ответ от карт Таро"}),p?(0,t.jsxs)("div",{className:"max-w-md mx-auto text-center space-y-6",children:[(0,t.jsx)("div",{className:"relative w-24 h-24 mx-auto",children:(0,t.jsx)("div",{className:"absolute inset-0 rounded-full border-4 border-secondary/20 border-t-secondary animate-spin"})}),(0,t.jsx)("h2",{className:"text-xl font-semibold",children:"Поиск специалиста"}),(0,t.jsx)("div",{className:"w-full bg-primary/10 rounded-full h-2",children:(0,t.jsx)("div",{className:"bg-secondary h-2 rounded-full transition-all duration-300",style:{width:"".concat(g,"%")}})}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Пожалуйста, подождите, пока мы найдем свободного специалиста..."})]}):f?(0,t.jsxs)("div",{className:"space-y-8 max-w-5xl mx-auto",children:[(0,t.jsx)(m.r,{reading:f}),v&&(0,t.jsxs)("div",{className:"bg-card rounded-lg border border-border p-6",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-secondary mb-4",children:"Интерпретация специалиста"}),(0,t.jsx)("div",{className:"prose prose-invert",children:v.split("\n").map((e,s)=>(0,t.jsx)("p",{className:"mb-4",children:e},s))})]}),(0,t.jsx)("div",{className:"flex justify-center",children:(0,t.jsx)(d.z,{variant:"outline",size:"lg",onClick:()=>{h(null),i(""),s(""),N("")},children:"Новое гадание"})})]}):(0,t.jsxs)("div",{className:"space-y-8 max-w-4xl mx-auto",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"1. Выберите тип расклада"}),(0,t.jsx)(o,{onSelect:e=>{s(e)},selectedSpreadId:e})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"2. Задайте вопрос картам"}),(0,t.jsx)(u,{placeholder:"Какой вопрос вы хотите задать картам?",value:r,onChange:e=>{i(e.target.value)},className:"min-h-[120px]"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mt-2",children:"Сформулируйте ясный и конкретный вопрос для более точного ответа."})]}),(0,t.jsx)("div",{className:"flex justify-center",children:(0,t.jsx)(d.z,{size:"lg",className:"bg-secondary text-secondary-foreground hover:bg-secondary/90",onClick:S,disabled:p,children:"Разложить карты"})})]})]})]})}},647:function(e,s,r){"use strict";r.d(s,{r:function(){return m}});var t=r(7437),a=r(2265),l=r(6691),n=r.n(l),i=r(9311);function d(e){let{card:s,position:r,interpretation:l,isRevealed:d=!0,onClick:c,className:o}=e,[m,u]=(0,a.useState)(d);return(0,t.jsxs)("div",{className:(0,i.cn)("card-flip relative w-full max-w-[200px] aspect-[2/3] cursor-pointer",o),onClick:()=>{!d&&(u(!0),c&&c())},children:[(0,t.jsxs)("div",{className:(0,i.cn)("card-flip-inner w-full h-full transition-transform duration-700",m?"flipped":""),children:[(0,t.jsx)("div",{className:"card-front absolute w-full h-full rounded-lg overflow-hidden border-2 border-secondary/50 card-glow",children:(0,t.jsx)("div",{className:"w-full h-full bg-card flex items-center justify-center p-4",children:(0,t.jsx)("div",{className:"w-full h-full bg-primary/20 rounded-md border border-secondary/30 flex items-center justify-center",children:(0,t.jsx)("div",{className:"text-secondary text-4xl font-bold transform rotate-45",children:"✦"})})})}),(0,t.jsx)("div",{className:"card-back absolute w-full h-full rounded-lg overflow-hidden border-2 border-secondary/50 card-glow",children:(0,t.jsxs)("div",{className:"relative w-full h-full bg-card",children:[(0,t.jsxs)("div",{className:"relative w-full h-2/3 overflow-hidden",children:[(0,t.jsx)(n(),{src:s.imageUrl,alt:s.nameRu,fill:!0,className:"object-cover"}),(0,t.jsx)("div",{className:"absolute inset-0 bg-gradient-to-b from-transparent to-card/90"})]}),(0,t.jsxs)("div",{className:"absolute bottom-0 left-0 right-0 p-3 text-center",children:[(0,t.jsx)("h3",{className:"text-secondary font-bold text-sm",children:s.nameRu}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1 line-clamp-2",children:r||s.keywords.join(", ")})]})]})})]}),m&&l&&(0,t.jsxs)("div",{className:"mt-3 text-sm text-foreground fade-in",children:[(0,t.jsx)("p",{className:"font-medium text-secondary",children:r}),(0,t.jsx)("p",{className:"mt-1",children:l})]})]})}var c=r(3023),o=r(9764);function m(e){let{reading:s,onSave:r,onShare:l,revealDelay:n=0}=e,[m,u]=(0,a.useState)([]),[x,f]=(0,a.useState)(n>0);return((0,a.useEffect)(()=>{if(n>0){let e=setTimeout(()=>{f(!1)},n);return()=>clearTimeout(e)}},[n]),(0,a.useEffect)(()=>{if(!x&&s.cards.length>0){let e=s.cards.map((e,s)=>s);e.forEach((e,s)=>{setTimeout(()=>{u(s=>[...s,e])},800*s)})}},[x,s.cards.length]),x)?(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,t.jsx)("div",{className:"relative w-24 h-24",children:(0,t.jsx)("div",{className:"absolute inset-0 rounded-full border-4 border-secondary/20 border-t-secondary animate-spin"})}),(0,t.jsx)("p",{className:"mt-6 text-lg text-center",children:"Поиск свободного специалиста..."}),(0,t.jsx)("p",{className:"mt-2 text-sm text-muted-foreground text-center",children:"Пожалуйста, подождите, пока мы соединяемся с картами Таро"})]}):(0,t.jsxs)("div",{className:"bg-card rounded-lg border border-border p-6 fade-in",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-secondary",children:"Результат гадания"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:(0,i.p6)(s.date)})]}),(0,t.jsxs)("div",{className:"flex gap-2 mt-4 sm:mt-0",children:[r&&(0,t.jsx)(c.z,{variant:"outline",size:"sm",onClick:r,children:"Сохранить"}),l&&(0,t.jsxs)(c.z,{variant:"secondary",size:"sm",onClick:l,children:[(0,t.jsx)(o.Z,{className:"h-4 w-4 mr-2"}),"Поделиться"]})]})]}),s.question&&(0,t.jsxs)("div",{className:"mb-6 p-4 bg-primary/10 rounded-lg border border-primary/20",children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-muted-foreground",children:"Ваш вопрос:"}),(0,t.jsx)("p",{className:"mt-1 text-foreground",children:s.question})]}),(0,t.jsx)("div",{className:(()=>{switch(s.spreadType){case"single":return"flex justify-center";case"three-card":return"grid grid-cols-1 sm:grid-cols-3 gap-6";case"celtic-cross":return"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6";case"love-spread":return"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6";default:return"flex flex-wrap justify-center gap-6"}})(),children:s.cards.map((e,s)=>(0,t.jsx)(d,{card:e.card,position:e.position,interpretation:e.interpretation,isRevealed:m.includes(s),className:"mx-auto"},s))})]})}},2621:function(e,s,r){"use strict";r.d(s,{p:function(){return a}});var t=r(2265);function a(){let[e,s]=(0,t.useState)([]),r=(0,t.useCallback)(e=>{let{title:r,description:t,variant:a="default",duration:l=5e3}=e,n=Math.random().toString(36).substring(2,9),i={id:n,title:r,description:t,variant:a,duration:l};return s(e=>[...e,i]),setTimeout(()=>{s(e=>e.filter(e=>e.id!==n))},l),n},[]),a=(0,t.useCallback)(e=>{s(s=>s.filter(s=>s.id!==e))},[]);return{toast:r,dismiss:a,toasts:e}}}},function(e){e.O(0,[395,284,81,282,971,864,744],function(){return e(e.s=9119)}),_N_E=e.O()}]);